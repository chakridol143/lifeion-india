<!-- =======================
   TOP INFO BAR
======================= -->
<div class="top-bar">
  Give Your Family the Gift of Healthy Water. Call
  <strong>844-335-2174</strong>
</div>

<!-- =======================
   MAIN HEADER
======================= -->
<div class="header-main">
  <div class="header-logo">
    <img src="/images/Ionizer_Logo.png" alt="Life Ionizers" />
  </div>

  <div class="header-search desktop-only">
    <div class="search-category">
      All <i class="bx bx-chevron-down"></i>
    </div>
    <input type="text" placeholder="Search for products" />
    <i class="bx bx-microphone"></i>
  </div>

  <div class="header-actions">
    <div class="icon-circle mobile-search-icon" (click)="openSearch()">
      <i class="bx bx-search"></i>
    </div>
    <div class="icon-circle"><i class="bx bx-user"></i></div>
    <div class="icon-circle cart"><i class="bx bx-cart"></i></div>
    <div class="icon-circle mobile-menu-icon" (click)="toggleMenu()">
      <i class="bx bx-menu" *ngIf="!menuOpen"></i>
      <i class="bx bx-x" *ngIf="menuOpen"></i>
    </div>
  </div>
</div>

<!-- =======================
   SEARCH OVERLAY
======================= -->
<div class="full-search" [class.active]="searchOpen">
  <div class="search-area">
    <i class="bx bx-search search-big-icon"></i>
    <input
      type="text"
      [(ngModel)]="overlaySearch"
      placeholder="SEARCH FOR..."
      (keydown.enter)="performSearch()"
      class="search-input"
    />
    <span class="close-search" (click)="closeSearch()">✕</span>
  </div>
</div>

<!-- =======================
   DESKTOP NAVIGATION
======================= -->
<nav class="header-nav desktop-only">

  <!-- ================= WATER SYSTEMS ONLY ================= -->
  <div
    class="nav-dropdown-wrapper"
    (mouseenter)="onDropdownHover()"
    (mouseleave)="onDropdownLeave()"
  >
    <a class="nav-link no-route">
      Water Systems <i class="bx bx-chevron-down"></i>
    </a>

    <!-- MEGA MENU -->
    <div class="mega-menu" *ngIf="showMegaMenu">
      <div class="mega-left">
        <div
          class="mega-category"
          *ngFor="let cat of categories"
          (mouseenter)="onCategoryHover(cat.category_id)"
        >
        <img
          [src]="'http://localhost:3000/assets/images/' + cat.image_url"/>
          {{ cat.name }} <span>›</span>
        </div>
      </div>

      <div class="mega-right">
        <div
    class="mega-product"
    *ngFor="let p of products"
    (click)="goToProduct(p.product_id)"
  >
          <img
          [src]="'http://localhost:3000/assets/images/' + p.image_url"
        />
          <p>{{ p.name }}</p>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="mega-right">
  <div
    class="mega-product"
    *ngFor="let p of products"
    (click)="goToProduct(p.product_id)"
  >
    <img [src]="'http://localhost:3000/assets/images/' + p.image_path" />
    <p>{{ p.name }}</p>
  </div>
</div> -->


  <!-- ================= OTHER NAV ITEMS ================= -->
  <ng-container *ngFor="let item of navItems">

    <!-- Skip Water Systems here -->
    <ng-container *ngIf="item.label !== 'Water Systems'">

      <!-- DROPDOWNS -->
      <div *ngIf="hasSubmenu(item)" class="nav-link nav-dropdown">
        <a href="javascript:void(0)">
          {{ item.label }} <i class="bx bx-chevron-down"></i>
        </a>

        <div class="dropdown-wrapper">
          <ul class="dropdown-menu">
            <li *ngFor="let sub of item.submenu">
              <a [routerLink]="sub.route">{{ sub.label }}</a>
            </li>
          </ul>
        </div>
      </div>

      <!-- NORMAL LINKS -->
      <a
        *ngIf="!hasSubmenu(item)"
        [routerLink]="item.route"
        class="nav-link"
      >
        {{ item.label }}
      </a>

    </ng-container>
  </ng-container>
</nav>


<!-- =======================
   MOBILE MENU OVERLAY
======================= -->
<div
  class="mobile-menu-overlay"
  [class.active]="menuOpen"
  (click)="closeMenu()"
></div>

<!-- =======================
   MOBILE MENU
======================= -->
<div class="mobile-menu-panel" [class.active]="menuOpen">
  <div class="mobile-menu-header">
    <span class="close-menu-btn" (click)="closeMenu()">✕</span>
  </div>

  <nav class="mobile-nav">
    <ng-container *ngFor="let item of navItems">

      <!-- MOBILE DROPDOWN -->
      <div *ngIf="item.submenu" class="mobile-nav-item">
        <div class="mobile-nav-link" (click)="toggleDropdown(item.label)">
          <span>{{ item.label }}</span>
          <i
            class="bx bx-chevron-down"
            [class.rotated]="activeDropdown === item.label"
          ></i>
        </div>

        <div
          class="mobile-submenu"
          [class.active]="activeDropdown === item.label"
        >
          <a
            *ngFor="let sub of item.submenu"
            [routerLink]="sub.route"
            class="mobile-submenu-link"
            (click)="onNavClick()"
          >
            {{ sub.label }}
          </a>
        </div>
      </div>

      <!-- MOBILE NORMAL LINK -->
      <a
        *ngIf="!item.submenu"
        [routerLink]="item.route"
        class="mobile-nav-link mobile-nav-item"
        (click)="onNavClick()"
      >
        {{ item.label }}
      </a>

    </ng-container>
  </nav>
</div>
